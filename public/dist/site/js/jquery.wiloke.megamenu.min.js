!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){var i=function(t,s){this.$el=e(t),this.options=e.extend({},i.defaults,s,this.dataOption()),this.alignMenu=this.options.alignMenu,this.style=this.options.style,this.theme=this.options.theme,this.hover=this.options.hover,this.breakpoint=this.options.breakpoint,this.menuClass=this.options.menuClass,this.itemClass=this.options.itemClass,this.megaClass=this.options.megaClass,this.subClass=this.options.subClass,this.dropdownClass=this.options.dropdownClass,this.barText=this.options.barText,this.init()};i.defaults={alignMenu:"left",theme:"",breakpoint:767,hover:!0,style:"wiloke-menu-horizontal",menuClass:".wiloke-menu-list",itemClass:".wiloke-menu-item",megaClass:".wiloke-menu-sub-mega",dropdownClass:".wiloke-menu-sub-dropdown",subClass:".wiloke-menu-sub"},i.prototype.dataOption=function(){return this.$el.data("options")},i.prototype.init=function(){this.onLoad(),this.onHover(),this.onClick(),this.MenuBar(),this.onResize(),this.onToggle()},i.prototype.horizontal=function(){var i=this,t=i.$el.offsetParent().innerWidth(),s=i.$el.offsetParent().offset();i.$el.find(i.subClass).each(function(n,a){var o=e(this),l=0,r=0,d="auto",h=o.data().width,u=o.data().align,f=o.parent(i.itemClass),c=f.offset();if((void 0===h||""==h||isNaN(h))&&(h=250),void 0!==u&&""!=u||(u="right"),h>t&&(h=t),"center"==u)if(f.hasClass("wiloke-menu-item-level-0")){var m=c.left-s.left+f.innerWidth()/2,p=t-m;l=m<h/2?-(c.left-s.left):p<h/2?-(h/2+(h/2-p))+f.innerWidth()/2:-h/2+f.innerWidth()/2}else u="right";if("left"==u&&(f.hasClass("wiloke-menu-item-level-0")?l=(v=c.left-s.left+f.innerWidth())>h?-h+f.innerWidth():-(c.left-s.left):((v=c.left-s.left)<h&&(h=v),l="auto",d="100%")),"right"==u)if(f.hasClass("wiloke-menu-item-level-0"))l=(v=t-(c.left-s.left))>h?0:v-h;else{var v=t-(c.left-s.left)-f.innerWidth();v<h&&(h=v),l="100%"}if(f.hasClass("wiloke-menu-item-level-0"))r=f.innerHeight();else if(o.hasClass(i.megaClass.replace(".",""))){var C=f.position().top,w=o.innerHeight(),k=f.parent(i.dropdownClass).innerHeight();if(w<k){var b=k-C;b<w&&(r=-(w-b))}else r=-C}0==o.children().length&&(o.addClass("wiloke-menu--hide"),o.next("ul").css("background",o.css("background")),o.next("ul").find("ul").css("background",o.css("background"))),o.css({width:h,left:l,top:r,right:d,bottom:"auto"})})},i.prototype.vertical=function(){var i=this,t=i.$el.offset(),s=i.$el.innerWidth(),n=i.$el.innerHeight(),a=e(window).innerWidth();i.$el.find(i.subClass).each(function(o,l){var r=e(this),d=0,h=0,u=0,f=r.data().width,c=r.closest(i.itemClass),m=c.innerWidth(),p=c.offset();if((void 0===f||""==f||isNaN(f))&&(f=250),c.hasClass("wiloke-menu-item-level-0")||(n=c.parent(i.dropdownClass).innerHeight()),"left"==i.alignMenu)(C=a-(p.left+m+t.left))<f&&(f=C),h="100%",u="auto";else{var v=a-(t.left+s),C=p.left-v;C<f&&(f=C),h="auto",u="100%"}if(r.hasClass(i.megaClass.replace(".",""))){var w=c.position().top,k=r.innerHeight();if(k<n){var b=n-w;b<k&&(d=-(k-b))}else d=-w}0==r.children().length&&(r.addClass("wiloke-menu--hide"),r.next("ul").css("background",r.css("background")),r.next("ul").find("ul").css("background",r.css("background"))),r.css({width:f,top:d,left:h,right:u})})},i.prototype.onLoad=function(){var i=e(window).innerWidth();this.breakpoint<=i?(this.$el.offsetParent().removeClass("wiloke-menu-responsive"),this.$el.removeClass("wiloke-menu-responsive").find(this.menuClass).css("display",""),"wiloke-menu-vertical"==this.style?this.vertical():this.horizontal()):(this.$el.addClass("wiloke-menu-responsive"),this.$el.offsetParent().addClass("wiloke-menu-responsive"),this.responsive())},i.prototype.responsive=function(){var i=this;i.$el.find(i.subClass).each(function(i,t){e(t).css({top:"",bottom:"",left:"",right:"",width:""})})},i.prototype.onResize=function(){var i=this;e(window).on("resize",function(e){var t=setTimeout(function(){i.onLoad(),clearTimeout(t)},50)})},i.prototype.onHover=function(){var i=this;i.$el.find(i.itemClass).on({mouseenter:function(){var t=e(window).innerWidth();if(i.hover&&!(i.breakpoint>t)){var s=e(this),n=s.find(">"+i.subClass),a=n.data("animated");if(n.length&&(s.addClass("wiloke-menu-item-active"),n.css({visibility:"visible",opacity:1}),void 0!==a&&""!=a)){n.addClass("animated "+a);var o=setTimeout(function(){n.removeClass("animated "+a),clearTimeout(o)},1e3)}}},mouseleave:function(){var t=e(window).innerWidth();if(i.hover&&!(i.breakpoint>t)){var s=e(this),n=s.find(">"+i.subClass),a=n.data("animated");n.length&&(s.removeClass("wiloke-menu-item-active"),n.css({display:"",visibility:"",opacity:""}),void 0!==a&&""!=a&&n.removeClass("animated "+a))}}})},i.prototype.onClick=function(){var i=this;i.$el.find(i.itemClass).on("click","> a",function(t){var s=e(window).innerWidth();if(!(i.hover||i.breakpoint>s)){var n=e(this).parent(i.itemClass),a=n.find("> "+i.subClass);if(n.parent().find("> "+i.itemClass).not(n).each(function(t,s){var n=e(this);n.removeClass("wiloke-menu-item-active"),n.find(i.subClass).css({display:"",visibility:"",opacity:""}).removeClass("animated").find(i.itemClass).removeClass("wiloke-menu-item-active")}),a.length){if(n.hasClass("wiloke-menu-item-active")){var o=a.data("animated");n.removeClass("wiloke-menu-item-active").find(i.subClass).css({display:"",visibility:"",opacity:""}),a.removeClass("animated "+o)}else{if(n.addClass("wiloke-menu-item-active"),void 0!==(o=a.data("animated"))&&""!=o){a.addClass("animated "+o);var l=setTimeout(function(){a.removeClass("animated "+o),clearTimeout(l)},1e3)}a.css({display:"block",visibility:"visible",opacity:1})}return!1}}}),e(document).on("click",function(t){e(t.target).closest(i.$el[0]).length||i.$el.find(i.itemClass).removeClass("wiloke-menu-item-active").find(i.subClass).each(function(i,t){var s=e(this),n=s.data("animated");n&&s.removeClass("animated "+n),s.css({display:"",visibility:"",opacity:""})})})},i.prototype.onToggle=function(){var i=this;e(i.$el).on("click",i.itemClass+" > a",function(t){var s=e(window).innerWidth();if(i.breakpoint>s){var n=e(this).parent(i.itemClass),a=n.find("> "+i.subClass),o=n.parent();if(o.length&&o.find("> "+i.itemClass).not(n).each(function(t,s){var n=e(this),a=n.find("> "+i.subClass);a.length&&(n.removeClass("wiloke-menu-item-active"),a.slideUp(300,function(){a.css({opacity:"",visibility:"",display:""})}))}),a.length)return n.toggleClass("wiloke-menu-item-active"),a.slideToggle(300,function(){n.hasClass("wiloke-menu-item-active")?a.css({opacity:1,visibility:"visible"}):a.css({opacity:"",visibility:"",display:""})}),!1}})},i.prototype.MenuBar=function(){var i=this,t=e('<div class="wiloke-menu-bar"><span class="wiloke-menu-bar__line"><span></span><span></span><span></span></span></div>');""!=this.barText&&t.append('<span class="wiloke-menu-bar__text">'+this.barText+"</span>"),i.$el.prepend(t),t.on("click",function(){var s=e(window).innerWidth();i.breakpoint>s&&(t.toggleClass("wiloke-menu-bar-active"),i.$el.find(i.menuClass).slideToggle())})},e.fn.WilokeMegaMenu=function(t){return this.each(function(){var s=e(this),n=s.data("WilokeMegaMenu");n||(n=new i(this,t),s.data("WilokeMegaMenu",n))})}});